# 漁師論理エンジン (FLE) プロジェクト・ロードマップ

## プロジェクト目標

FF14における複雑な釣りの抽選論理を数学的にシミュレートする「漁師論理エンジン」を構築し、特定のターゲット魚を最短時間（最高効率）で獲得するための**最適スキル使用戦略**を科学的に検討・提示することを目標とする。

---

## ステップ 0：ゲームドメイン定義の確立（完了）

シミュレータの基盤となるゲーム内仕様を解析し、論理モデルとして構造化した段階。

* **論理階層の定義**: 釣り場・環境条件・餌の組み合わせによって「基礎重み」と「基礎待機時間」が決定される階層構造を解明。
* **物理定数の特定**: キャスト（1.0s）、ルアー（2.5s）、撒き餌（1.0s）などの動作硬直時間（GDS定数）を秒単位で定義。
* **ルアーアクションの一般化**: ルアー使用回数（0〜3回）において発生しうる「発見」「型確定」「何もなし」の分岐を整理し、全32パターンの発生論理を数式化。
* **隠し魚出現ロジックの解明**: 未発見状態では重み 0 となり、「発見」が発生した瞬間から固有のヒット率が適用される特殊な抽選ロジックを定義。

## ステップ 1：手動設定シミュレータの構築（完了 - v2.0）

特定の条件と特定のスキル結果を手動で設定し、その「一点」における効率を評価できるツールを実装した段階。

* **対話型UIの実装**: 釣り場、天気、餌、ルアー使用結果をユーザーが自由に選択できるインターフェースを構築。
* **個別シナリオの評価指標算出**: ユーザーが設定した「特定のルアー結果パターン」におけるヒット率、実効待機時間、平均サイクル時間をリアルタイム計算。
* **期待待機秒数（ターゲットヒット時間期待）の導入**: ターゲット1匹を得るために必要な「正味の待機時間」を算出する独自指標を確立。
* **計算プロセスの透明化**: 詳細ビューを実装し、検索キー、確率配列、重み補正、数式の実行トレースを可視化。
* **厳密なエラーハンドリング**: データ欠損（NULL）を検知して計算を停止する安全機構の実装。

## ステップ 2：戦略パターン評価とシナリオ合算（次フェーズ）

個別の結果ではなく、「このスキルセット（戦略）を使った場合、平均してどうなるか」という戦略そのものの優劣を評価する段階。

* **全シナリオの加重平均算出**: 例えば「ルアーを3回振る」という戦略を選んだ際に発生しうる全パターン（発見タイミングや型確定の成否）を確率で重み付けし、戦略全体の期待値を自動合算する。
* **戦略の自動評価**: 撒き餌、トレードリリース、ルアー回数などの組み合わせ（戦略）ごとに発生する期待値を計算し、どの打ち手が最も効率的かを定量的に比較可能にする。
* **制限事項**: このステップでは、GP（ギャザラーポイント）の自然回復や消費リソースの限界は考慮せず、時間効率の理論最大値を追求する。

## ステップ 3：GP消費を考慮した実践的リソース最適化（最終フェーズ）

実際のプレイ環境に即し、有限のリソースであるGP消費と回復のバランスを含めたシミュレーションを行う最終段階。

* **GP管理ロジックの導入**: スキル使用ごとのGP消費量と、キャストごとのGP自然回復量を計算モデルに組み込む。
* **長期効率のシミュレート**: 「GPが尽きたら素振りに戻る」といった現実的な運用フローを含め、スキル使用戦略の組み合わせ（マクロ戦略）ごとの評価を行う。
* **最適戦略の提案**: プレイヤーの現在GPやハイコーディアルの使用状況等に基づき、ターゲット獲得効率を最大化する「最高効率のスキル回し」を提示する。

---

**文書履歴**:

* 2026/01/11: ステップ1完了 (v2.0)。エラーハンドリング強化、詳細ビュー拡充、UI調整を実施。
* 2026/01/09: ロードマップ策定。ステップ 0 および ステップ 1 を現況に合わせて詳細化。