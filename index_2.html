<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>FLE Simulator v1.5 - Debug Enhanced</title>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
<div class="app-container">
    <header class="app-header">
        <h1>FISHERMAN LOGIC ENGINE <small>v1.5</small></h1>
        <div>
            <span id="db-status" style="color:var(--accent-red); font-size:0.8rem; margin-right:10px;">OFFLINE</span>
            <button class="btn-load" onclick="document.getElementById('json-upload').click()">Load JSON</button>
            <input type="file" id="json-upload" class="hidden" accept=".json">
        </div>
    </header>

    <main class="main-layout">
        <aside class="panel">
            <h3>📍 環境・スキル</h3>
            <div class="input-group">
                <label>釣り場</label>
                <select id="sel-spot"><option value="">JSONをロードしてください</option></select>
            </div>
            <div class="input-group">
                <label>天気/時間</label>
                <select id="sel-weather" disabled></select>
            </div>
            <div class="input-group">
                <label>餌</label>
                <select id="sel-bait" disabled></select>
            </div>
            <div class="input-group">
                <label>ターゲット魚</label>
                <select id="sel-target" disabled></select>
            </div>
            
            <hr style="border:0; border-top:1px solid var(--border); margin:15px 0;">
            
            <div class="toggle-group">
                <input type="checkbox" id="chk-chum"> <span>撒き餌 (Chum)</span>
            </div>
            <div class="toggle-group">
                <input type="checkbox" id="chk-catch"> <span>全部釣り上げる</span>
            </div>
            
            <div class="input-group">
                <label>トレードリリース</label>
                <select id="sel-slap" disabled></select>
            </div>
            <div class="input-group">
                <label>ルアー種類</label>
                <select id="sel-lure">
                    <option value="なし">使用しない</option>
                    <option value="アンビシャスルアー">アンビシャスルアー</option>
                    <option value="モデストルアー">モデストルアー</option>
                </select>
            </div>

            <div id="lure-steps-area" class="hidden">
                <div class="input-group">
                    <label>ルアー回数</label>
                    <select id="sel-lure-n">
                        <option value="1">1回</option><option value="2">2回</option><option value="3">3回</option>
                    </select>
                </div>
                <div id="step-selectors"></div>
            </div>
        </aside>

        <article class="panel debug-panel">
            <h3>⚙️ デバッグ・解析ビュー</h3>
            
            <div class="debug-section">
                <label>【GDS定数】</label>
                <div id="debug-constants" class="mini-table"></div>
            </div>

            <div class="debug-section">
                <label>【シナリオ解析】</label>
                <div id="debug-scenario" class="info-box"></div>
            </div>

            <div class="debug-section">
                <label>【重み・確率分配の内訳】</label>
                <div id="debug-weights" class="mini-table"></div>
            </div>

            <div class="debug-section">
                <label>【数式の実行トレース】</label>
                <div id="debug-math" class="formula-box"></div>
            </div>
        </article>

        <section class="panel">
            <div class="metric-card highlight">
                <span style="font-size:0.8rem;">3分間期待釣果 (Target)</span>
                <span id="res-efficiency" class="value">0.00 <small>匹</small></span>
            </div>
            <h3>📊 ヒット率一覧</h3>
            <table>
                <thead><tr><th>魚種</th><th>演出</th><th>確率</th><th>待機</th></tr></thead>
                <tbody id="res-table-body"></tbody>
            </table>
            <div style="margin-top:15px; font-size:0.8rem; color:var(--text-muted);">
                平均サイクル時間: <span id="res-cycle">0.0</span>s
            </div>
        </section>
    </main>
</div>
<script src="assets/main.js"></script>
</body>
</html>